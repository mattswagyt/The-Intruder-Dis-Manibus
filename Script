-- The Intruder - Dis Manibus (By BMF)
-- Direct-destroy variant (no safety wrappers for destroys)

-- Variables / Services
local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local StarterGui = game:GetService("StarterGui")
local UIS = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = workspace
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Create UI Elements (same layout as your House script)
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local LocationLabel = Instance.new("TextLabel")
local ErrorLog = Instance.new("TextLabel")
local UIListLayout = Instance.new("UIListLayout")

-- UI Properties (unchanged layout)
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.Name = "IntruderUI_DisManibus"

MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

Title.Parent = MainFrame
Title.Text = "The Intruder - Dis Manibus (By BMF)"
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18

LocationLabel.Parent = MainFrame
LocationLabel.Text = "Location: Loading..."
LocationLabel.Size = UDim2.new(1, 0, 0, 30)
LocationLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
LocationLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
LocationLabel.Font = Enum.Font.SourceSans
LocationLabel.TextSize = 16

ErrorLog.Parent = MainFrame
ErrorLog.Text = "Error Log: None"
ErrorLog.Size = UDim2.new(1, 0, 0, 30)
ErrorLog.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
ErrorLog.TextColor3 = Color3.fromRGB(255, 85, 85)
ErrorLog.Font = Enum.Font.SourceSans
ErrorLog.TextSize = 14
ErrorLog.TextWrapped = true
ErrorLog.TextYAlignment = Enum.TextYAlignment.Top

UIListLayout.Parent = MainFrame
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- Toggle UI with Delete key (same behavior)
UIS.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.Delete then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- simple safe wrapper to write errors to ErrorLog (keeps log, but does not protect destroys)
local function safeDo(fn)
    local ok, err = pcall(fn)
    if not ok then
        ErrorLog.Text = "Error Log: " .. tostring(err)
        warn("[DisManibusUI] Error:", err)
    else
        ErrorLog.Text = "Error Log: None"
    end
    return ok, err
end

-- Function to create buttons (same as before)
local function createButton(name, callback)
    local Button = Instance.new("TextButton")
    Button.Parent = MainFrame
    Button.Text = name
    Button.Size = UDim2.new(1, 0, 0, 30)
    Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.Font = Enum.Font.SourceSans
    Button.TextSize = 16
    Button.MouseButton1Click:Connect(function()
        pcall(callback)
    end)
    return Button
end

-- Track location loop
spawn(function()
    while true do
        local ok, result = pcall(function()
            return workspace.Values.intruderPos.Value
        end)

        if ok then
            LocationLabel.Text = "Location: " .. tostring(result)
        else
            LocationLabel.Text = "Location: Error"
            ErrorLog.Text = "Error Log: Failed to fetch intruder location."
        end
        wait(1)
    end
end)

-- Helper: get current character & root part
local function getCharacter()
    local char = LocalPlayer.Character
    if not char then return nil end
    local hrp = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChildWhichIsA("BasePart")
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    return char, hrp, humanoid
end

local function teleportToVector3(vec3)
    local char, hrp = getCharacter()
    if not char or not hrp then
        error("Character or root part not found")
    end
    hrp.CFrame = CFrame.new(vec3)
end

-- BUTTONS (same order as before)

createButton("Infinite Yield", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
end)

createButton("Dex Explorer", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/infyiff/backup/main/dex.lua"))()
end)

createButton("Full Bright", function()
    safeDo(function()
        Lighting.Brightness = 5
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
    end)
end)

createButton("Unlock Camera", function()
    safeDo(function()
        LocalPlayer.CameraMode = Enum.CameraMode.Classic
        LocalPlayer.CameraMinZoomDistance = 0
        LocalPlayer.CameraMaxZoomDistance = 50
    end)
end)

-- Teleport buttons
createButton("Skip Long Aah Stairs", function() teleportToVector3(Vector3.new(-63, 7, -46)) end)
createButton("Main Room", function() teleportToVector3(Vector3.new(174, 4, 12)) end)
createButton("Vent Room", function() teleportToVector3(Vector3.new(179, 4, -17)) end)
createButton("Room 1", function() teleportToVector3(Vector3.new(196, 4, -71)) end)
createButton("Room 2", function() teleportToVector3(Vector3.new(102, 75, -72)) end)
createButton("Interact (Hospital)", function() teleportToVector3(Vector3.new(210, 4, -123)) end)
createButton("Elevator (Hospital)", function() teleportToVector3(Vector3.new(97, 4, -110)) end)

------------------------------------------------------
-- * UPDATED GOD MODE (ONLY destroys EXACT paths you listed)
------------------------------------------------------

local godModeEnabled = false
local godLoopThread = nil

local function performGodDestruction()
    workspace.WHITEBOXOFSHAME:Destroy()
    workspace.Sounds.Damage:Destroy()
    workspace.Sounds.voices.HenryHurt:Destroy()

    ReplicatedStorage.Events.Die:Destroy()
    ReplicatedStorage.Events.ouch:Destroy()
    ReplicatedStorage.Events.takeDamage:Destroy()
    ReplicatedStorage.Events.taken:Destroy()
    ReplicatedStorage.Events.thingKill:Destroy()
    ReplicatedStorage.Events.hasPlrDied:Destroy()

    Workspace[LocalPlayer.Name].Health:Destroy()
    LocalPlayer.isDead:Destroy()

    -- HUD disable
    PlayerGui.Health.Frame.Visible = false
    PlayerGui.Health.Heart.Visible = false
    PlayerGui.Health.Heart.Active = false
end

createButton("God Mode", function()
    godModeEnabled = not godModeEnabled
    if godModeEnabled then
        godLoopThread = task.spawn(function()
            while godModeEnabled do
                performGodDestruction()
                task.wait(0.35)
            end
        end)
    end
end)

------------------------------------------------------
-- NEW BUTTONS (in same order)
------------------------------------------------------

-- Remove Floor 1 Triggers
createButton("Remove Floor 1 Triggers", function()
    workspace.Stairwell.Trigger:Destroy()
    workspace.Stairwell:GetChildren()[25]:Destroy()
end)

-- Remove Floor 2 Triggers
createButton("Remove Floor 2 Triggers", function()
    workspace.Floor2.Trigger:Destroy()
    workspace.Floor2:GetChildren()[33]:Destroy()
    workspace.Floor2:GetChildren()[32]:Destroy()
end)

-- Bypass Jason
createButton("Bypass Jason", function()
    workspace.Mansion.JasonTall3:Destroy()
    workspace.CameraPos.JasonScare:Destroy()
    workspace.Sounds.JasonScream:Destroy()
    workspace.Mansion.JasonTall3.Head.JasonCry:Destroy()
    ReplicatedStorage.Events.Scare:Destroy()
end)

------------------------------------------------------

print("âœ… The Intruder - Dis Manibus (By BMF) Script Loaded Successfully")
